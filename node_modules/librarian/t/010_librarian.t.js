StartTest(function (t) {
    
    //==================================================================================================================================================================================
    t.diag("Sanity")
    
    var Joose       = require('../../../')
    var Librarian   = require('../lib/Librarian')
    var File        = require('../lib/File')
    
    t.ok(Librarian, 'Librarian is here')

    
    //==================================================================================================================================================================================
    t.diag("Creating library")

    var path            = require('path')
    
    var librarian       = new Librarian({
        root        : path.normalize(path.join(__dirname, '../test_data'))
    })
    
    var file        = librarian.getFile('lib/Backend/Cool.js')

    
    //==================================================================================================================================================================================
    t.diag("Get content of")
    
    var content     = librarian.getContentOf(file)
    
    t.like(content, "isa     : require('../Backend'),", 'Correct content for file')
    

    //==================================================================================================================================================================================
    t.diag("Raw dependencies")
    
    t.isDeeply(file.rawDependencies(), [ 'jojo', 'joose', '../Backend' ], 'Correct raw deps')
    
    
    //==================================================================================================================================================================================
    t.diag("Resolve")
    
    var additionalDeps      = {}
    var resolveJojo         = librarian.resolve('jojo', file, additionalDeps)
    
    t.is(resolveJojo, 'node_modules/jojo/super/cool.js', 'Correctly resolved jojo')
    t.isDeeply(additionalDeps, {
        
        'node_modules/jojo/package.json'        : librarian.getFile('node_modules/jojo/package.json')
        
    }, 'Correctly resolved jojo')
    

    //==================================================================================================================================================================================
    t.diag("In depth dependencies")
    
//    var realDeps    = file.getInDepthDependencies()
//    var deps        = {}
//    
//    Joose.O.each(deps, function (value, name) {
//        t.isa_ok(value, File, 'All dependencies are files')
//        
//        deps[ name ] = true
//    })
//    
//    t.isDeeply(deps, {
//        
//        'node_modules/jojo/super/cool.js'       : true,
//        'node_modules/jojo/package.json'        : true,
//        'node_modules/joose/index.js'           : true,
//        'lib/Backend.js'                        : true,
//        'node_modules/jobo/index.js'            : true,
//        'node_modules/cujo/index.js'            : true
//        
//    }, 'Correct dependencies for cool backend found')
    

    t.done()
})